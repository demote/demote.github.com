---
layout: post
title: "Use Toast in Android Service"
description: "how to show a toast message in an Android service"
category: blog
tags: [Tech, Android]
---
{% include JB/setup %}

[Toast](http://developer.android.com/guide/topics/ui/notifiers/toasts.html) is a pretty common way of giving simple feedback of a user's operation. It is quite easy to use within an Activity or Fragment, just as the [official developer guide's  sample](http://developer.android.com/guide/topics/ui/notifiers/toasts.html#Basics):

    Context context = getApplicationContext();
    CharSequence text = "Hello toast!";
    int duration = Toast.LENGTH_SHORT;

    Toast toast = Toast.makeText(context, text, duration);
    toast.show();

The parameters of `Toast.makeText()` seems to imply that as long as you have a **context** of an application, you can show the toast. But if you try, you will find that directly trying to show a toast within a service will not work. It does not show up even though without any error.  
In fact, you have to run `makeText()` in a **UI Thread** to make it work[^quote1]. Since service is not running in a UI thread, [`Handler`](https://developer.android.com/reference/android/os/Handler.html) can be used to post a runnable in UI thread. Specifically, you can create a private class in service like:

    private class ToastRunnable implements Runnable {
	    String mText;

	    public ToastRunnable(String text) {
	        mText = text;
	    }

	    @Override
	    public void run(){
	         Toast.makeText(getApplicationContext(), mText, Toast.LENGTH_SHORT).show();
	    }
	}

and initialize a handler in service's create method (normally `onStartCommand()` or `onHandleIntent()`) like:

    mHandler = new Handler(this.getMainLooper());

finally a method of service which uses the handler to post a Runnable:

    private void postServiceToast(String text) {
		mHandler.post(new ToastRunnable(text));
	}

Then, you can use the `postServiceToast()` method to throw a toast within a service.

---eof---

---

[^quote1]:http://stackoverflow.com/a/12731284/1929093

> By [Jiang Ji](http://demote.github.io/about.html)
> Written with [StackEdit](https://stackedit.io/).